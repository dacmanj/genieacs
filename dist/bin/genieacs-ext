#!/usr/bin/env node
"use strict";const e=new Set,s=process.argv[2];let c;function n(e){if(!e)return null;if(!e.name)return{code:"ext",message:""+e};const s={code:"ext."+e.name,message:e.message,detail:{name:e.name,message:e.message}};if(e.stack){s.detail.stack=e.stack;const c=s.detail.stack.match(/\s+at\s[^\s]+\s\(.*genieacs-ext:.+\)/);c&&(s.detail.stack=s.detail.stack.slice(0,c.index))}return s}process.on("uncaughtException",(s=>{const c=n(s);e.forEach((e=>{process.send([e,c,null])})),e.clear(),process.disconnect()})),process.on("message",(t=>{if(e.add(t[0]),!c){const e=process.env.GENIEACS_EXT_DIR;process.chdir(e),c=require(`${e}/${s}`)}const a=t[1][0];if(c[a])c[a](t[1].slice(1),((s,c)=>{e.delete(t[0])&&process.send([t[0],n(s),c])}));else{const e={code:"ext",message:`No such function '${a}' in extension '${s}'`};process.send([t[0],e,null])}})),process.on("SIGINT",(()=>{}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuaWVhY3MtZXh0Iiwic291cmNlcyI6WyIuLi8uLi9iaW4vZ2VuaWVhY3MtZXh0LnRzIl0sInNvdXJjZXNDb250ZW50IjpudWxsLCJuYW1lcyI6WyJqb2JzIiwiU2V0IiwiZmlsZU5hbWUiLCJwcm9jZXNzIiwiYXJndiIsInNjcmlwdCIsImVycm9yVG9GYXVsdCIsImVyciIsIm5hbWUiLCJjb2RlIiwibWVzc2FnZSIsImZhdWx0IiwiZGV0YWlsIiwic3RhY2siLCJzdGFja1RyaW1JbmRleCIsIm1hdGNoIiwic2xpY2UiLCJpbmRleCIsIm9uIiwiZm9yRWFjaCIsImpvYklkIiwic2VuZCIsImNsZWFyIiwiZGlzY29ubmVjdCIsImFkZCIsImN3ZCIsImVudiIsImNoZGlyIiwicmVxdWlyZSIsImZ1bmNOYW1lIiwicmVzIiwiZGVsZXRlIl0sIm1hcHBpbmdzIjoiO2FBcUJBLE1BQU1BLEVBQU8sSUFBSUMsSUFDWEMsRUFBV0MsUUFBUUMsS0FBSyxHQUM5QixJQUFJQyxFQUVKLFNBQVNDLEVBQWFDLEdBQ3BCLElBQUtBLEVBQUssT0FBTyxLQUVqQixJQUFLQSxFQUFJQyxLQUFNLE1BQU8sQ0FBRUMsS0FBTSxNQUFPQyxRQUFTLEdBQUdILEdBRWpELE1BQU1JLEVBQWUsQ0FDbkJGLEtBQU0sT0FBT0YsRUFBSUMsS0FDakJFLFFBQVNILEVBQUlHLFFBQ2JFLE9BQVEsQ0FDTkosS0FBTUQsRUFBSUMsS0FDVkUsUUFBU0gsRUFBSUcsVUFJakIsR0FBSUgsRUFBSU0sTUFBTyxDQUNiRixFQUFNQyxPQUFjLE1BQUlMLEVBQUlNLE1BRTVCLE1BQU1DLEVBQWlCSCxFQUFNQyxPQUFjLE1BQUVHLE1BQzNDLHdDQUVFRCxJQUNGSCxFQUFNQyxPQUFjLE1BQUlELEVBQU1DLE9BQWMsTUFBRUksTUFDNUMsRUFDQUYsRUFBZUcsUUFLckIsT0FBT04sRUFHVFIsUUFBUWUsR0FBRyxxQkFBc0JYLElBQy9CLE1BQU1JLEVBQVFMLEVBQWFDLEdBQzNCUCxFQUFLbUIsU0FBU0MsSUFDWmpCLFFBQVFrQixLQUFLLENBQUNELEVBQU9ULEVBQU8sVUFFOUJYLEVBQUtzQixRQUNMbkIsUUFBUW9CLGdCQUdWcEIsUUFBUWUsR0FBRyxXQUFZUixJQUdyQixHQUZBVixFQUFLd0IsSUFBSWQsRUFBUSxLQUVaTCxFQUFRLENBQ1gsTUFBTW9CLEVBQU10QixRQUFRdUIsSUFBc0IsaUJBQzFDdkIsUUFBUXdCLE1BQU1GLEdBQ2RwQixFQUFTdUIsUUFBUSxHQUFHSCxLQUFPdkIsS0FHN0IsTUFBTTJCLEVBQVduQixFQUFRLEdBQUcsR0FFNUIsR0FBS0wsRUFBT3dCLEdBU1p4QixFQUFPd0IsR0FBVW5CLEVBQVEsR0FBR00sTUFBTSxJQUFJLENBQUNULEVBQUt1QixLQUNyQzlCLEVBQUsrQixPQUFPckIsRUFBUSxLQUV6QlAsUUFBUWtCLEtBQUssQ0FBQ1gsRUFBUSxHQUFJSixFQUFhQyxHQUFNdUIsV0FaL0MsQ0FDRSxNQUFNbkIsRUFBUSxDQUNaRixLQUFNLE1BQ05DLFFBQVMscUJBQXFCbUIsb0JBQTJCM0IsTUFFM0RDLFFBQVFrQixLQUFLLENBQUNYLEVBQVEsR0FBSUMsRUFBTyxXQVlyQ1IsUUFBUWUsR0FBRyxVQUFVIn0=
